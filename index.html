<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Googleスプレッドシート表示（順位色付き・中央寄せ）</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body {
    margin:0;
    padding:0;
    font-family:sans-serif;
    background:#f0f0f0;
  }

  .container {
    padding: 10px;
    overflow-x:auto; /* 横スクロール可能 */
    max-height: 100vh;
  }

  table {
    border-collapse: collapse;
    table-layout: auto; /* 列幅自動調整 */
    width: auto;        /* 内容に合わせる */
    max-width: 100%;    /* 画面幅を超えない */
    margin: 0 auto;     /* 表全体を中央寄せ */
  }

  th, td {
    border: 1px solid #ccc;
    padding: 8px;
    text-align: center; /* 文字を中央寄せ */
    white-space: nowrap; /* 文字列に合わせて列幅を調整 */
    max-width: 300px;    /* 長すぎる場合は最大幅 */
    overflow: hidden;
    text-overflow: ellipsis; /* 長い文字は省略表示 */
  }

  @media (max-width: 600px) {
    th, td {
      padding: 6px;
      font-size: 14px;
    }
  }
</style>
</head>
<body>
<div class="container">
  <table id="sheetTable"></table>
</div>

<script>
// Google スプレッドシートの公開用 URL（tsv 出力用）
const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSZkFdVPEnuMTjF-sy8cSUeKEXmVbSUpkblKDFgdVDje5c99_Zt9of2GDSYv7HiN9P3ExV_vrxllMdv/pub?gid=1845744529&single=true&output=tsv";

// 順位に応じた色
const RANK_COLORS = {
  "1": "#f9ca00",  // ゴールド
  "2": "#c0c0c0",  // シルバー
  "3": "#762f07"   // ブロンズ
};

async function loadSheet() {
  try {
    // キャッシュ回避
    const res = await fetch(SHEET_URL + "&cb=" + Date.now());
    const tsv = await res.text();
    const rows = tsv.trim().split("\n").map(r => r.split("\t"));

    const table = document.getElementById("sheetTable");
    table.innerHTML = "";

    rows.forEach((row, i) => {
      const tr = document.createElement("tr");
      row.forEach((cell, j) => {
        const td = document.createElement(i===0 ? "th" : "td");
        td.textContent = cell;

        // 順位列に応じた色付け
        if (i > 0) {
          const rank = row[0].trim(); // 順位は1列目
          const color = RANK_COLORS[rank];
          if (color && (j === 0 || j === 1 || j === 2)) {
            td.style.backgroundColor = color;
            td.style.color = "#ffffff"; // 文字色を白に
          }
        }

        tr.appendChild(td);
      });
      table.appendChild(tr);
    });
  } catch (err) {
    console.error("スプレッドシートの読み込みに失敗しました", err);
  }
}

// 初回ロード
loadSheet();

// 10秒ごとに更新
setInterval(loadSheet, 10000);
</script>
</body>
</html>
