<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>スプレッドシート表示</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<style>
    body { margin:0; padding:0; background:#f0f0f0; font-family:sans-serif; }
    table { width:100%; border-collapse: collapse; }
    th, td { border:1px solid #ccc; padding:8px; text-align:center; }
</style>
</head>
<body>
<div id="sheetContainer"></div>

<script>
const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSZkFdVPEnuMTjF-sy8cSUeKEXmVbSUpkblKDFgdVDje5c99_Zt9of2GDSYv7HiN9P3ExV_vrxllMdv/pub?output=tsv";

// 順位に応じた色
const RANK_COLORS = {
  "1": "#f9ca00",
  "2": "#c0c0c0",
  "3": "#762f07"
};

async function loadSheet() {
    const res = await fetch(SHEET_URL + "?t=" + new Date().getTime());
    const text = await res.text();
    const rows = text.trim().split("\n").map(r => r.split("\t"));

    const container = document.getElementById("sheetContainer");
    container.innerHTML = "";

    const table = document.createElement("table");

    rows.forEach((row, rowIndex) => {
        const tr = document.createElement("tr");

        row.forEach((cell, colIndex) => {
            const td = document.createElement(rowIndex===0 ? "th" : "td");
            td.textContent = cell;

            // ✅ 1行目は見出しとしてそのまま
            if(rowIndex > 0) {
                const rank = row[0];  // 順位列を1列目と仮定
                if(RANK_COLORS[rank] && (colIndex===0 || colIndex===1 || colIndex===2)) {
                    // 順位、チーム名、得点列に同色
                    td.style.backgroundColor = RANK_COLORS[rank];
                    td.style.color = "white";
                }
            }

            tr.appendChild(td);
        });

        table.appendChild(tr);
    });

    container.appendChild(table);
}

// 初回読み込みと5秒ごとの更新
loadSheet();
setInterval(loadSheet, 5000);
</script>
</body>
</html>
