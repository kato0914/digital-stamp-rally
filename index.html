<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Googleスプレッドシート表示（リアルタイム更新）</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body { margin:0; padding:0; font-family:sans-serif; background:#f0f0f0; }
  table { border-collapse: collapse; width: 100%; }
  td, th { border: 1px solid #ccc; padding: 8px; text-align: left; }
  .container { padding: 10px; overflow:auto; max-height: 100vh; }
</style>
</head>
<body>
<div class="container">
  <table id="sheetTable"></table>
</div>

<script>
// Google スプレッドシートの公開用 URL（tsv 出力用）
const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSZkFdVPEnuMTjF-sy8cSUeKEXmVbSUpkblKDFgdVDje5c99_Zt9of2GDSYv7HiN9P3ExV_vrxllMdv/pub?gid=1845744529&single=true&output=tsv";

// スプレッドシートを取得して HTML 表示
async function loadSheet() {
  try {
    const res = await fetch(SHEET_URL + "&cb=" + Date.now()); // キャッシュ回避
    const tsv = await res.text();
    const rows = tsv.trim().split("\n").map(r => r.split("\t"));

    const table = document.getElementById("sheetTable");
    table.innerHTML = "";

    rows.forEach((row, i) => {
      const tr = document.createElement("tr");
      row.forEach(cell => {
        const td = document.createElement(i===0 ? "th" : "td");
        td.textContent = cell;
        tr.appendChild(td);
      });
      table.appendChild(tr);
    });
  } catch (err) {
    console.error("スプレッドシートの読み込みに失敗しました", err);
  }
}

// 初回ロード
loadSheet();

// 10秒ごとに更新
setInterval(loadSheet, 10000);
</script>
</body>
</html>
